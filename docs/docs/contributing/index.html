<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.66">
<title data-react-helmet="true">Contributing | ReScript Apollo Client</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Contributing | ReScript Apollo Client"><meta data-react-helmet="true" name="description" content="Core Philosopies"><meta data-react-helmet="true" property="og:description" content="Core Philosopies"><meta data-react-helmet="true" property="og:url" content="https://reasonml-community.github.io/rescript-apollo-client/rescript-apollo-client/docs/contributing"><link data-react-helmet="true" rel="shortcut icon" href="/rescript-apollo-client/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://reasonml-community.github.io/rescript-apollo-client/rescript-apollo-client/docs/contributing"><link rel="stylesheet" href="/rescript-apollo-client/styles.eb460e67.css">
<link rel="preload" href="/rescript-apollo-client/styles.4f26d451.js" as="script">
<link rel="preload" href="/rescript-apollo-client/runtime~main.4eb533cf.js" as="script">
<link rel="preload" href="/rescript-apollo-client/main.3497dc83.js" as="script">
<link rel="preload" href="/rescript-apollo-client/1.890b6a27.js" as="script">
<link rel="preload" href="/rescript-apollo-client/2.ceeba443.js" as="script">
<link rel="preload" href="/rescript-apollo-client/16.a0feb1ec.js" as="script">
<link rel="preload" href="/rescript-apollo-client/17.194727ce.js" as="script">
<link rel="preload" href="/rescript-apollo-client/935f2afb.4fd836bc.js" as="script">
<link rel="preload" href="/rescript-apollo-client/17896441.70f001b2.js" as="script">
<link rel="preload" href="/rescript-apollo-client/4d54d076.c84a7447.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/rescript-apollo-client/"><img class="navbar__logo" src="/rescript-apollo-client/img/small_logo.png" alt="ReScript Apollo Client Logo"><strong class="navbar__title">ReScript Apollo Client</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rescript-apollo-client/docs/">Docs</a><a href="https://github.com/reasonml-community/rescript-apollo-client/releases/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Changelog</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rescript-apollo-client/docs/contributing">Contributing</a><a href="https://github.com/reasonml-community/rescript-apollo-client" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/rescript-apollo-client/"><img class="navbar__logo" src="/rescript-apollo-client/img/small_logo.png" alt="ReScript Apollo Client Logo"><strong class="navbar__title">ReScript Apollo Client</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/rescript-apollo-client/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/reasonml-community/rescript-apollo-client/releases/" target="_blank" rel="noopener noreferrer" class="menu__link">Changelog</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/rescript-apollo-client/docs/contributing">Contributing</a></li><li class="menu__list-item"><a href="https://github.com/reasonml-community/rescript-apollo-client" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Contributing</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="core-philosopies"></a>Core Philosopies<a aria-hidden="true" tabindex="-1" class="hash-link" href="#core-philosopies" title="Direct link to heading">#</a></h2><ul><li>Provide 1:1 mapping to Javascript <em>then</em> use those as building blocks for more &quot;reasonable&quot; ergonomics</li><li>Follow a consistent pattern for bindings</li><li>Avoid partial types or bindings if possible</li><li>Encourage incremental contribution from the community rather than biting off more than one person can chew</li></ul><p>There&#x27;s nothing fancy about this library. It tends to view the problem of bindings as a people problem (how can we leverage the power of numbers) rather than a programming problem (automatic conversion from typescript‚Äîwould be amazing!). As such, a lot of detail is paid to consistency and clarity with the hope of maximizing human ability to both add and verify that bindings are correct. The long-term success or failure of this library is intended to be dependent on active community contribution rather than the efforts of a few individuals. Will it work? That&#x27;s up to you, dear reader ‚ù§Ô∏è</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="following-a-consistent-pattern"></a>Following a Consistent Pattern<a aria-hidden="true" tabindex="-1" class="hash-link" href="#following-a-consistent-pattern" title="Direct link to heading">#</a></h3><p>At the file level, bindings to Javascript packages should mirror the directory structure in the JS package. No thinking required! This has the side benefit of being able to navigate to any import you see in the javascript docs via filepath pattern, but it&#x27;s primary purpose is consistency. It should be easy for anyone else to see exactly what you&#x27;re binding to and encourages consistent naming rules.</p><p>At the code level, all JS bindings should go in a <code>Js_</code> module of some sort. At first it seems ridiculous, but it pays off at scale. (See <strong>Reasoning Behind <code>Js_</code> modules</strong>)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="avoiding-partial-types"></a>Avoiding Partial Types<a aria-hidden="true" tabindex="-1" class="hash-link" href="#avoiding-partial-types" title="Direct link to heading">#</a></h3><p>Please type something as completely as possible when you come across it or leave it for someone else (if nothing else, you can use an abstract type so things will still flow through everywhere and people can cast it when in a hurry). This way no one has to go back and duplicate that work of tracing through the same code you were just in <em>and</em> we can trust that if a binding exists, it&#x27;s probably complete and we can just reuse.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="style-guidelines"></a>Style Guidelines<a aria-hidden="true" tabindex="-1" class="hash-link" href="#style-guidelines" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="directory-structure-and-module-naming"></a>Directory Structure and Module Naming<a aria-hidden="true" tabindex="-1" class="hash-link" href="#directory-structure-and-module-naming" title="Direct link to heading">#</a></h3><p>Each directory should have a corresponding Reason module</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@apollo/client/react/hooks/useQuery.js</span></div></div></div></div></div><p>should become</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">reason-react-hooks/src/react/hooks/ApolloClient__React_Hooks_UseQuery.re</span></div></div></div></div></div><p>in reason.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="breaking-it-down-12__3_4"></a>Breaking it down: <code>/[1]/[2]__[3]_[4]</code><a aria-hidden="true" tabindex="-1" class="hash-link" href="#breaking-it-down-12__3_4" title="Direct link to heading">#</a></h4><ol><li>Reason files should be located in the same directory structure as the js counterpart (usually there is a <code>.d.ts</code> for every <code>.js</code> file so we can think of them interchangeably)</li><li>All module names should be prefixed with <code>ApolloClient__</code> &quot;namespace&quot;</li><li>File names reflect the directory structure</li><li>Files should be named the same as the js counterpart</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="types"></a>Types<a aria-hidden="true" tabindex="-1" class="hash-link" href="#types" title="Direct link to heading">#</a></h3><ul><li>Please use the same naming as typescript where possible</li><li>Every type goes in its own module with a <code>type t</code> (exception: see SubStypes)</li><li>Every type module should contain a <code>type t</code>, a <code>Js_</code> module with a <code>type t</code>, and a <code>toJs</code> or <code>fromJs</code> conversion function. <code>t =&gt; Js_.t</code> or <code>Js_.t =&gt; t</code></li><li>Paste the type definition from the <code>.d.ts</code> file above the <code>type t</code> in the <code>Js_</code> module</li><li>If data requires parsing/serializing create a new record even if the shape is the same. This ensures you don&#x27;t forget to parse somewhere.</li><li>Prefer single types when the more complicated type in a union can express both <code>shouldResubscribe?: boolean | ((options: BaseSubscriptionOptions&lt;TData, TVariables&gt;) =&gt; boolean);</code></li><li>Do all of this even if it doesn&#x27;t need it (See Reasoning Behind <code>Js_</code> modules)</li></ul><p>Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">// #1 - create a Js_ module for your type</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">module Js_ = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // #2 - paste the definition from the .js file here</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // #3 - add the `.js` representation of type t = ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">// #4  - add the Reason representation of type t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">// #4a - you can use `type t = Js_.t` if they are _exactly_ the same</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">// #4b - if they are the exact same _shape_ but requires parsing or serializing, *define a new record of the same shape* so we can leverage the fact that records are nominally typed to prevent someone forgetting to convert somewhere</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">// #5 - add `toJs` or `fromJs`. They often require parsing: `let fromJs: Js_.t(&#x27;jsData, ~parse: &#x27;jsData =&gt; &#x27;data) =&gt; t(&#x27;data)`</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="subtypes"></a>SubTypes<a aria-hidden="true" tabindex="-1" class="hash-link" href="#subtypes" title="Direct link to heading">#</a></h4><p>Sometimes multiple types were required to represent a single type in TypeScript. In order to help make it clear what is a binding to an actual type and what is just needed by Reason, we take a similar naming approach to the modules (prefixing with the parent). For instance, <code>Apollo_Client__React_Types.QueryResult.Raw</code> has a <code>type t</code> that uses <code>t_fetchMoreOptions</code> which in turn uses <code>t_fetchMoreOptions_updateQueryOptions</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="binding-to-js-module-exports"></a>Binding to Js Module Exports<a aria-hidden="true" tabindex="-1" class="hash-link" href="#binding-to-js-module-exports" title="Direct link to heading">#</a></h3><p><code>externals</code> go under a <code>Js_</code> module and any types they reference should be <code>Js_.t</code> versions.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="binding-to-methods"></a>Binding to Methods<a aria-hidden="true" tabindex="-1" class="hash-link" href="#binding-to-methods" title="Direct link to heading">#</a></h3><p>Prefer T-first with <code>[@bs.send]</code>. Again, <code>externals</code> go under a <code>Js_</code> module with a <code>type t</code> and any types they reference should be <code>Js_.t</code> versions.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="binding-to-objects"></a>Binding to Objects<a aria-hidden="true" tabindex="-1" class="hash-link" href="#binding-to-objects" title="Direct link to heading">#</a></h3><p>Use records</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="binding-to-enums"></a>Binding to Enums<a aria-hidden="true" tabindex="-1" class="hash-link" href="#binding-to-enums" title="Direct link to heading">#</a></h3><p>Prefer standard variants. <code>jsConverter</code> works great for ints, but otherwise use manual <code>toJs</code> and <code>fromJs</code> functions. The reasoning is that Apollo may very well be an entry point into ReasonML and we don&#x27;t want to <em>immediately</em> expose users to polymorphic variants.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="general"></a>General<a aria-hidden="true" tabindex="-1" class="hash-link" href="#general" title="Direct link to heading">#</a></h3><ul><li>Prefer T-first because that&#x27;s the Reason community default</li><li>Hooks are T-last because that makes sense given their usage</li><li>ApolloClient methods are a Frankenstein T-first <em>and</em> T-last because they want to maintain similarity with hooks api, but are also T-first due to [@bs.send] and T-first preference</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="reasoning-behind-js_-modules"></a>Reasoning behind <code>Js_</code> modules<a aria-hidden="true" tabindex="-1" class="hash-link" href="#reasoning-behind-js_-modules" title="Direct link to heading">#</a></h3><p>Here&#x27;s a typical example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module TypeName = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  module Js_ = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type t;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  type t = Js_.t;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div></div></div></div></div><p>Stupid, right? But bear with me it pays off in the big picture. What if we need to parse/serialize some data which happens a lot in this library?</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module TypeName = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged">  module Js_ = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)">-   type t;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   type t(&#x27;jsData) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+     data: &#x27;jsData,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)">- type t = Js_.t;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+ type t(&#x27;data) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   data: &#x27;data</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+ };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+ let toJs: t =&gt; Js_.t = (t, ~serialize) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   data: serialize(t.data)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+ };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token plain">};</span></div></div></div></div></div><p>Nice, now when wherever we say we want a <code>Typename.t</code>, we can never forget to parse because records are nominally typed.</p><p>What if you need to construct a class or object with a bunch of optional properties?</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module TypeName = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged">  module Js_ = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    type t(&#x27;jsData) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      data: &#x27;jsData,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+     optionalProp: option(bool),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">    };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   type make_options(&#x27;jsData) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+     data: &#x27;jsData,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+     optionalProp: option(bool),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   [@bs.new] [@bs.module &quot;someModule&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   external make = (make_options(&#x27;jsData)) =&gt; t = &quot;someClass&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged">  type t(&#x27;data) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    data: &#x27;data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   optionalProp: option(bool),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged">  let toJs: t =&gt; Js_.t = (t) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    data: serialize(t.data)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   optionalProp: t.optionalProp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+ let make: (~data, ~optionalProp=?, ()) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   Js_.make(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+     toJs({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+         data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+         optionalProp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+       },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+       ~serialize,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+     )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token plain">};</span></div></div></div></div></div><p>It&#x27;s nice to have all this conversion stuff wrapped in one module and have consistent naming. All of it together really begins to pay off when we have types that reference many other types.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module TypeName = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged">  module Js_ = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    type t(&#x27;jsData) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      data: &#x27;jsData,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+     reusedType: ReusedType.Js_.t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">    };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged">    type make_options(&#x27;jsData) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      data: &#x27;jsData,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      optionalProp: option(bool),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+     reusedType: ReusedType.Js_.t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    [@bs.new] [@bs.module &quot;someModule&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    external make = (make_options(&#x27;jsData)) =&gt; t = &quot;someClass&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged">  type t(&#x27;data) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    data: &#x27;data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    optionalProp: option(bool),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   reusedType: ReusedType.t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)">- let toJs: t =&gt; Js_.t = (t) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+ let toJs: t =&gt; Js_.t = (t, ~serialize) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">    data: serialize(t.data)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    optionalProp: t.optionalProp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   reusedType: t.reusedType-&gt;ReusedType.toJs(~serialize)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)">- let make: (~data, ~optionalProp=?, ()) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+ let make: (~data, ~optionalProp=?, ~reusedType, ~serialize, ()) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">    Js_.make(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      toJs({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">          data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">          optionalProp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+         reusedType</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">        ~serialize,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain">};</span></div></div></div></div></div><p>Does <code>reusedType</code> need some conversion or parsing or serializing? If we&#x27;ve done things right, all we need to confirm is that any <code>Js_</code> modules reference the <code>Js_.t</code> versions of types, the compiler will do the rest! In this case, it turns out it needs also needs parse!</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button tabindex="0" type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module TypeName = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged">  module Js_ = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    type t(&#x27;jsData) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      data: &#x27;jsData,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      reusedType: ReusedType.Js_.t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged">    type make_options(&#x27;jsData) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      data: &#x27;jsData,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      optionalProp: option(bool),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      reusedType: ReusedType.Js_.t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    [@bs.new] [@bs.module &quot;someModule&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    external make = (make_options(&#x27;jsData)) =&gt; t = &quot;someClass&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token unchanged">  type t(&#x27;data) = {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    data: &#x27;data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    optionalProp: option(bool),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    reusedType: ReusedType.t</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)">- let toJs: t =&gt; Js_.t = (t, ~serialize) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+ let toJs: t =&gt; Js_.t = (t, ~parse, ~serialize) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">    data: serialize(t.data)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    optionalProp: t.optionalProp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)">-   reusedType: t.reusedType-&gt;ReusedType.toJs(~serialize)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+   reusedType: t.reusedType-&gt;ReusedType.toJs(~parse, ~serialize)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">  };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)">- let make: (~data, ~optionalProp=?, ~reusedType, ~serialize, ()) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token deleted-sign deleted" style="color:rgb(255, 85, 114)"></span><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)">+ let make: (~data, ~optionalProp=?, ~parse, ~reusedType, ~serialize, ()) =&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token inserted-sign inserted" style="color:rgb(195, 232, 141)"></span><span class="token unchanged">    Js_.make(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      toJs({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">          data,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">          optionalProp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">          reusedType</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">        ~serialize,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">      )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged">    );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token unchanged"></span><span class="token plain">};</span></div></div></div></div></div><p>Regarding the actual module naming, I tried <code>JS</code>, but I would accidentally type <code>Js</code> all the time and not see it. I found adding the <code>_</code> helped it stick out. ü§∑</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/reasonml-community/rescript-apollo-client/edit/master/documentation/docs/contributing.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#core-philosopies" class="table-of-contents__link">Core Philosopies</a><ul><li><a href="#following-a-consistent-pattern" class="table-of-contents__link">Following a Consistent Pattern</a></li><li><a href="#avoiding-partial-types" class="table-of-contents__link">Avoiding Partial Types</a></li></ul></li><li><a href="#style-guidelines" class="table-of-contents__link">Style Guidelines</a><ul><li><a href="#directory-structure-and-module-naming" class="table-of-contents__link">Directory Structure and Module Naming</a></li><li><a href="#types" class="table-of-contents__link">Types</a></li><li><a href="#binding-to-js-module-exports" class="table-of-contents__link">Binding to Js Module Exports</a></li><li><a href="#binding-to-methods" class="table-of-contents__link">Binding to Methods</a></li><li><a href="#binding-to-objects" class="table-of-contents__link">Binding to Objects</a></li><li><a href="#binding-to-enums" class="table-of-contents__link">Binding to Enums</a></li><li><a href="#general" class="table-of-contents__link">General</a></li><li><a href="#reasoning-behind-js_-modules" class="table-of-contents__link">Reasoning behind <code>Js_</code> modules</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Built with Docusaurus.</div></div></div></footer></div>
<script src="/rescript-apollo-client/styles.4f26d451.js"></script>
<script src="/rescript-apollo-client/runtime~main.4eb533cf.js"></script>
<script src="/rescript-apollo-client/main.3497dc83.js"></script>
<script src="/rescript-apollo-client/1.890b6a27.js"></script>
<script src="/rescript-apollo-client/2.ceeba443.js"></script>
<script src="/rescript-apollo-client/16.a0feb1ec.js"></script>
<script src="/rescript-apollo-client/17.194727ce.js"></script>
<script src="/rescript-apollo-client/935f2afb.4fd836bc.js"></script>
<script src="/rescript-apollo-client/17896441.70f001b2.js"></script>
<script src="/rescript-apollo-client/4d54d076.c84a7447.js"></script>
</body>
</html>